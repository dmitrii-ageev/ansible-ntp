---
- block:
    - name: Create a daemon group
      group:
        name: "{{ ntp__group }}"
        system: true

    - name: Create a daemon user
      user:
        name: "{{ ntp__user }}"
        group: "{{ ntp__group }}"
        system: true
        createhome: false
        comment: "{{ ntp__description }}"
  when: ntp__user != "root"

- name: Install required packages
  yum:
    name: "{{ ntp__packages }}"
    state: present
    update_cache: true
  notify: Start ntp service

- name: Create service directories
  file:
    path: "{{ item }}"
    state: directory
    owner: "{{ ntp__user }}"
    group: "{{ ntp__group }}"
    mode: "{{ ntp__dir_mode }}"
  loop: "{{ ntp__directories }}"
  notify: Restart ntp service
...
